<% disp_add = @permissions.include?('write')
   disp_change = (@groups.length > 1)
   if disp_change == true then
     last_menu = "change"
   elsif disp_add then
     last_menu = "add"
   else
     last_menu = "home"
   end
%>
<div class="grid_16 menu_fun">
<ul role="menubar" id="menu-1" class="menu">

  <li id="" class="<%= params[:controller].eql?('collection') ? 'active' : '' %> <%= last_menu.eql?('home') ? 'last' : '' %>">
    <%= link_to('Collection home', {:controller => 'collection', :action => 'index', :group => @group.id}, {:role => 'menuitem'}) %>
  </li>

  <% if disp_add then %>
    <li id="" class="<%= params[:controller].eql?('object') and params[:action].eql?('add') ? 'active' : '' %> <%= last_menu.eql?('add') ? 'last' : '' %>">
      <%= link_to('Add object', {:controller => 'object', :action => 'add', :group => @group.id}, {:role => 'menuitem'}) %>
    </li>
  <% end %>

  <% if disp_change then %>
    <li class="" id="" class="last">
      <%= link_to('Change collection', {:controller => 'home', :action => 'choose_collection', :group => @group.id},
          {:role => 'menuitem', :tabindex => "0", :class => 'sub', 'aria-haspopup' => "true"}) %>
      <ul role="menu">
        <% curr_item = 0
        @groups.each do |grp|
          curr_item += 1 %>
          <li id="" class="<%= curr_item == @groups.length ? 'last' : '' %>">
            <%= link_to(grp.description, {:controller => 'collection', :action => 'index', :group => grp.id}) %>
          </li>
        <% end %>
      </ul>
    <% end %>
  </li>
</ul>

</div>

<script type='text/javascript'>
   document.observe('dom:loaded', function(){
      new ProtoFish('menu-1', '200', 'hover', false, true, true);
   });
</script>
<div class="clear"></div>